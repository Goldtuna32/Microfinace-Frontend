<div class="container-fluid py-5 animate__animated animate__fadeIn">
  <div class="row justify-content-center">
    <div class="col-lg-8 col-xl-6">
      <!-- Card with animated entrance -->
      <div class="card border-0 shadow-lg animate__animated animate__zoomIn">
        <!-- Card Header with gradient background -->
        <div class="card-header bg-primary bg-gradient text-white py-3">
          <div class="d-flex justify-content-between align-items-center">
            <h4 class="m-0">
              <i class="bi bi-building-gear me-2"></i> Create New Branch
            </h4>
            <button type="button" class="btn btn-sm btn-light" routerLink="branch/list">
              <i class="bi bi-arrow-left me-1"></i> Back to List
            </button>
          </div>
        </div>
        
        <!-- Card Body -->
        <div class="card-body p-4 p-md-5">
          <form [formGroup]="branchForm" (ngSubmit)="onSubmit()" class="needs-validation" novalidate>
            <div class="row g-4">
              <!-- Branch Name -->
              <div class="col-md-6">
                <label for="branchName" class="form-label fw-bold">
                  <i class="bi bi-building text-primary me-1"></i> Branch Name <span class="text-danger">*</span>
                </label>
                <div class="input-group has-validation">
                  <span class="input-group-text bg-light"><i class="bi bi-pencil-square"></i></span>
                  <input type="text" id="branchName" formControlName="branchName"
                         class="form-control" 
                         [ngClass]="{
                           'is-invalid': branchForm.controls['branchName'].touched && branchForm.controls['branchName'].invalid,
                           'is-valid': branchForm.controls['branchName'].touched && branchForm.controls['branchName'].valid
                         }"
                         placeholder="Main Branch">
                  <div *ngIf="branchForm.controls['branchName'].touched && branchForm.controls['branchName'].invalid"
                       class="invalid-feedback animate__animated animate__fadeIn">
                    <div *ngIf="branchForm.controls['branchName'].errors?.['required']">
                      <i class="bi bi-exclamation-circle me-1"></i> Branch Name is required
                    </div>
                    <div *ngIf="branchForm.controls['branchName'].errors?.['duplicate']">
                      <i class="bi bi-exclamation-triangle me-1"></i> Branch Name already exists
                    </div>
                  </div>
                </div>
              </div>

              <!-- Phone Number -->
              <div class="col-md-6">
                <label for="phoneNumber" class="form-label fw-bold">
                  <i class="bi bi-telephone text-primary me-1"></i> Phone Number <span class="text-danger">*</span>
                </label>
                <div class="input-group has-validation">
                  <span class="input-group-text bg-light"><i class="bi bi-telephone-outbound"></i></span>
                  <input type="tel" id="phoneNumber" formControlName="phoneNumber"
                         class="form-control"
                         [ngClass]="{
                           'is-invalid': branchForm.controls['phoneNumber'].touched && branchForm.controls['phoneNumber'].invalid,
                           'is-valid': branchForm.controls['phoneNumber'].touched && branchForm.controls['phoneNumber'].valid
                         }"
                         placeholder="09123456789">
                  <div *ngIf="branchForm.controls['phoneNumber'].touched && branchForm.controls['phoneNumber'].invalid"
                       class="invalid-feedback animate__animated animate__fadeIn">
                    <div *ngIf="branchForm.controls['phoneNumber'].errors?.['required']">
                      <i class="bi bi-exclamation-circle me-1"></i> Phone is required
                    </div>
                    <div *ngIf="branchForm.controls['phoneNumber'].errors?.['pattern']">
                      <i class="bi bi-exclamation-triangle me-1"></i> Invalid phone format
                    </div>
                    <div *ngIf="branchForm.controls['phoneNumber'].errors?.['duplicate']">
                      <i class="bi bi-exclamation-triangle me-1"></i> Phone already registered
                    </div>
                  </div>
                </div>
              </div>

              <!-- Email -->
              <div class="col-md-6">
                <label for="email" class="form-label fw-bold">
                  <i class="bi bi-envelope text-primary me-1"></i> Email <span class="text-danger">*</span>
                </label>
                <div class="input-group has-validation">
                  <span class="input-group-text bg-light"><i class="bi bi-at"></i></span>
                  <input type="email" id="email" formControlName="email"
                         class="form-control"
                         [ngClass]="{
                           'is-invalid': branchForm.controls['email'].touched && branchForm.controls['email'].invalid,
                           'is-valid': branchForm.controls['email'].touched && branchForm.controls['email'].valid
                         }"
                         placeholder="branch@example.com">
                  <div *ngIf="branchForm.controls['email'].touched && branchForm.controls['email'].invalid"
                       class="invalid-feedback animate__animated animate__fadeIn">
                    <div *ngIf="branchForm.controls['email'].errors?.['required']">
                      <i class="bi bi-exclamation-circle me-1"></i> Email is required
                    </div>
                    <div *ngIf="branchForm.controls['email'].errors?.['email']">
                      <i class="bi bi-exclamation-triangle me-1"></i> Invalid email format
                    </div>
                    <div *ngIf="branchForm.controls['email'].errors?.['duplicate']">
                      <i class="bi bi-exclamation-triangle me-1"></i> Email already registered
                    </div>
                  </div>
                </div>
              </div>

              <!-- Address Section -->
              <div class="col-12 mt-4">
                <h5 class="fw-bold text-primary border-bottom pb-2">
                  <i class="bi bi-geo-alt me-2"></i> Address Information
                </h5>
              </div>

              <!-- Region -->
              <div class="col-md-4">
                <label for="region" class="form-label fw-bold">
                  <i class="bi bi-globe-americas text-primary me-1"></i> Region <span class="text-danger">*</span>
                </label>
                <select id="region" formControlName="region" (change)="onRegionChange()"
                        class="form-select"
                        [ngClass]="{
                          'is-invalid': branchForm.controls['region'].touched && branchForm.controls['region'].invalid,
                          'is-valid': branchForm.controls['region'].touched && branchForm.controls['region'].valid
                        }">
                  <option value="">Select Region</option>
                  <option *ngFor="let region of regions" [value]="region">{{ region }}</option>
                </select>
                <div *ngIf="branchForm.controls['region'].touched && branchForm.controls['region'].invalid"
                     class="invalid-feedback animate__animated animate__fadeIn">
                  <i class="bi bi-exclamation-circle me-1"></i> Please select a region
                </div>
              </div>

              <!-- District -->
              <div class="col-md-4">
                <label for="district" class="form-label fw-bold">
                  <i class="bi bi-map text-primary me-1"></i> District <span class="text-danger">*</span>
                </label>
                <select id="district" formControlName="district" (change)="onDistrictChange()"
                        [disabled]="districts.length === 0"
                        class="form-select"
                        [ngClass]="{
                          'is-invalid': branchForm.controls['district'].touched && branchForm.controls['district'].invalid,
                          'is-valid': branchForm.controls['district'].touched && branchForm.controls['district'].valid
                        }">
                  <option value="">Select District</option>
                  <option *ngFor="let district of districts" [value]="district">{{ district }}</option>
                </select>
                <div *ngIf="branchForm.controls['district'].touched && branchForm.controls['district'].invalid"
                     class="invalid-feedback animate__animated animate__fadeIn">
                  <i class="bi bi-exclamation-circle me-1"></i> Please select a district
                </div>
              </div>

              <!-- Township -->
              <div class="col-md-4">
                <label for="township" class="form-label fw-bold">
                  <i class="bi bi-pin-map text-primary me-1"></i> Township <span class="text-danger">*</span>
                </label>
                <select id="township" formControlName="township"
                        [disabled]="townships.length === 0"
                        class="form-select"
                        [ngClass]="{
                          'is-invalid': branchForm.controls['township'].touched && branchForm.controls['township'].invalid,
                          'is-valid': branchForm.controls['township'].touched && branchForm.controls['township'].valid
                        }">
                  <option value="">Select Township</option>
                  <option *ngFor="let township of townships" [value]="township">{{ township }}</option>
                </select>
                <div *ngIf="branchForm.controls['township'].touched && branchForm.controls['township'].invalid"
                     class="invalid-feedback animate__animated animate__fadeIn">
                  <i class="bi bi-exclamation-circle me-1"></i> Please select a township
                </div>
              </div>

              <!-- Street -->
              <div class="col-12">
                <label for="street" class="form-label fw-bold">
                  <i class="bi bi-signpost text-primary me-1"></i> Street Address <span class="text-danger">*</span>
                </label>
                <div class="input-group has-validation">
                  <span class="input-group-text bg-light"><i class="bi bi-signpost-2"></i></span>
                  <input type="text" id="street" formControlName="street"
                         class="form-control"
                         [ngClass]="{
                           'is-invalid': branchForm.controls['street'].touched && branchForm.controls['street'].invalid,
                           'is-valid': branchForm.controls['street'].touched && branchForm.controls['street'].valid
                         }"
                         placeholder="123 Main Street">
                  <div *ngIf="branchForm.controls['street'].touched && branchForm.controls['street'].invalid"
                       class="invalid-feedback animate__animated animate__fadeIn">
                    <div *ngIf="branchForm.controls['street'].errors?.['required']">
                      <i class="bi bi-exclamation-circle me-1"></i> Street address is required
                    </div>
                    <div *ngIf="branchForm.controls['street'].errors?.['duplicate']">
                      <i class="bi bi-exclamation-triangle me-1"></i> Address already registered
                    </div>
                  </div>
                </div>
              </div>

              <!-- Submit Button -->
              <div class="col-12 mt-4">
                <div class="d-grid">
                  <button type="submit" [disabled]="!isFormFullyFilled()"
                          class="btn btn-primary btn-lg py-3 animate__animated animate__pulse animate__infinite animate__slower">
                    <i class="bi bi-check-circle-fill me-2"></i> Create Branch
                  </button>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>