<!-- Enhanced HTML Structure -->
<div class="container">
  <div class="card">
    <!-- Card Header -->
    <div class="card-header bg-primary text-white">
      <div class="d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
          <i class="bi bi-collection me-3 fs-3"></i>
          <div>
            <h4 class="mb-0 fw-bold">{{ showDeleted ? 'Deleted Collateral Types' : 'Active Collateral Types' }}</h4>
            <small class="opacity-75">{{ dataSource.data.length }} items found</small>
          </div>
        </div>
        <button (click)="toggleDeletedList()" class="btn btn-light btn-sm toggle-btn">
          <i class="bi" [ngClass]="{'bi-eye-slash-fill': showDeleted, 'bi-eye-fill': !showDeleted}"></i>
          {{ showDeleted ? 'View Active' : 'View Deleted' }}
        </button>
      </div>
    </div>

    <!-- Card Body -->
    <div class="card-body">
      <!-- Loading Indicator -->
      <div *ngIf="loading" class="text-center my-5 py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3 text-muted">Loading collateral types...</p>
      </div>

      <!-- Error Message -->
      <div *ngIf="errorMessage" class="alert alert-danger d-flex align-items-center animate__animated animate__shakeX" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-3 fs-4"></i>
        <div>
          <h5 class="alert-heading mb-1">Error Occurred</h5>
          <p class="mb-0">{{ errorMessage }}</p>
        </div>
      </div>

      <!-- Search and Add New -->
      <div class="row mb-4">
        <div class="col-md-8">
          <div class="input-group">
            <span class="input-group-text bg-white border-end-0">
              <i class="bi bi-search text-muted"></i>
            </span>
            <input type="text" 
                   class="form-control border-start-0" 
                   placeholder="Search by name or ID..." 
                   (keyup)="applyFilter($event)"
                   aria-label="Search collateral types">
          </div>
        </div>
        <!-- <div class="col-md-4 d-flex justify-content-end">
          <button class="btn btn-primary" (click)="addNewCollateralType()">
            <i class="bi bi-plus-circle"></i> Add New
          </button>
        </div> -->
      </div>

      <!-- Data Table -->
      <div class="table-responsive">
        <table mat-table [dataSource]="dataSource" matSort class="table table-striped table-hover mb-0">
          <!-- ID Column -->
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
            <td mat-cell *matCellDef="let row" class="fw-semibold text-primary">#{{ row.id }}</td>
          </ng-container>

          <!-- Name Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
            <td mat-cell *matCellDef="let row">
              <div class="d-flex align-items-center">
                <i class="bi bi-tag-fill me-2 text-muted"></i>
                <span>{{ row.name }}</span>
              </div>
            </td>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
            <td mat-cell *matCellDef="let row">
              <span class="badge" [ngClass]="{
                'bg-success bg-opacity-10 text-success': row.status === 1, 
                'bg-danger bg-opacity-10 text-danger': row.status !== 1
              }">
                <i class="bi" [ngClass]="{
                  'bi-check-circle-fill': row.status === 1, 
                  'bi-x-circle-fill': row.status !== 1
                }"></i>
                {{ row.status === 1 ? 'Active' : 'Inactive' }}
              </span>
            </td>
          </ng-container>

          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef class="text-end">Actions</th>
            <td mat-cell *matCellDef="let row" class="text-end">
              <div class="d-flex justify-content-end gap-2">
                <button (click)="editCollateralType(row)" 
                        class="action-btn btn btn-sm btn-outline-primary" 
                        title="Edit">
                  <i class="bi bi-pencil"></i>
                </button>
                
                <button *ngIf="row.status === 1" 
                        (click)="deleteCollateralType(row.id)" 
                        class="action-btn btn btn-sm btn-outline-danger" 
                        title="Delete">
                  <i class="bi bi-trash"></i>
                </button>
                
                <button *ngIf="row.status !== 1" 
                        (click)="restoreCollateralType(row.id)" 
                        class="action-btn btn btn-sm btn-outline-success" 
                        title="Restore">
                  <i class="bi bi-arrow-counterclockwise"></i>
                </button>
              </div>
            </td>
          </ng-container>

          <!-- Table Rows -->
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
              [class.table-primary]="row.status === 1"
              [class.table-light]="row.status !== 1"></tr>
        </table>

        <!-- Empty State -->
        <div *ngIf="!loading && dataSource.data.length === 0" class="text-center py-5">
          <i class="bi bi-inboxes display-4 text-muted opacity-25 mb-3"></i>
          <h5 class="text-muted">No collateral types found</h5>
          <p class="text-muted mb-4">Try adjusting your search or add a new collateral type</p>
          <!-- <button class="btn btn-primary pulse-animation" (click)="addNewCollateralType()">
            <i class="bi bi-plus-circle"></i> Create New Collateral Type
          </button> -->
        </div>
      </div>

      <!-- Pagination -->
      <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" 
                     showFirstLastButtons 
                     class="mt-4 border-top pt-3"
                     [class.d-none]="dataSource.data.length === 0"></mat-paginator>
    </div>
  </div>
</div>