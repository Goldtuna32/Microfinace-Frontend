<!-- Enhanced HTML Structure -->
<div class="collateral-dashboard">
  <div class="dashboard-card">
    <!-- Card Header -->
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="card-title">
        <i class="bi bi-file-earmark-lock"></i>
        {{ showDeleted ? 'Deleted Collateral' : 'Active Collateral' }}
      </h5>
      <button (click)="toggleDeletedList()" class="toggle-btn btn btn-light">
        <i class="bi me-1" [ngClass]="{'bi-eye-slash': showDeleted, 'bi-eye': !showDeleted}"></i>
        {{ showDeleted ? 'View Active' : 'View Deleted' }}
      </button>
    </div>

    <!-- Card Body -->
    <div class="card-body">
      <!-- Loading State -->
      <div *ngIf="loading" class="text-center my-5 py-5">
        <div class="loading-spinner spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3 text-muted">Loading collateral data...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error" class="error-alert alert alert-danger d-flex align-items-center animate__animated animate__shakeX" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-3 fs-4"></i>
        <div>
          <h5 class="alert-heading mb-1">Error Loading Data</h5>
          <p class="mb-0">{{ error }}</p>
        </div>
      </div>

      <!-- Data Table -->
      <div *ngIf="!loading && !error" class="table-responsive">
        <table class="table table-hover align-middle">
          <thead>
            <tr>
              <th scope="col" (click)="sort('collateralCode')" class="cursor-pointer">
                Code <i class="bi bi-arrow-down-up ms-1"></i>
              </th>
              <th scope="col" (click)="sort('description')" class="cursor-pointer">
                Description <i class="bi bi-arrow-down-up ms-1"></i>
              </th>
              <th scope="col" (click)="sort('value')" class="cursor-pointer">
                Value <i class="bi bi-arrow-down-up ms-1"></i>
              </th>
              <th scope="col" (click)="sort('status')" class="cursor-pointer">
                Status <i class="bi bi-arrow-down-up ms-1"></i>
              </th>
              <th scope="col" (click)="sort('date')" class="cursor-pointer">
                Date <i class="bi bi-arrow-down-up ms-1"></i>
              </th>
              <th scope="col" class="text-end">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="paginatedCollaterals.length === 0">
              <td colspan="6" class="text-center empty-state">
                <i class="bi bi-inboxes empty-state-icon"></i>
                <h5 class="text-muted">{{ showDeleted ? 'No deleted collaterals found' : 'No active collaterals found' }}</h5>
                <p class="text-muted">Try adjusting your filters or add new collateral</p>
              </td>
            </tr>
            <tr *ngFor="let collateral of paginatedCollaterals" class="animate__animated animate__fadeIn">
              <td class="fw-semibold">{{ collateral.collateralCode }}</td>
              <td>{{ collateral.description }}</td>
              <td>{{ collateral.value | currency }}</td>
              <td>
                <span class="status-badge" [ngClass]="{'badge-active': collateral.status === 1, 'badge-inactive': collateral.status !== 1}">
                  <i class="bi me-1" [ngClass]="{'bi-check-circle-fill': collateral.status === 1, 'bi-x-circle-fill': collateral.status !== 1}"></i>
                  {{ collateral.status === 1 ? 'Active' : 'Inactive' }}
                </span>
              </td>
              <td>{{ collateral.date | date:'mediumDate' }}</td>
              <td class="text-end">
                <div class="d-flex justify-content-end gap-2">
                  <button (click)="openDetailPage(collateral)" class="action-btn btn btn-sm btn-outline-info" title="View Details">
                    <i class="bi bi-eye"></i>
                  </button>
                  <button *ngIf="collateral.status === 1" (click)="editCollateral(collateral)" class="action-btn btn btn-sm btn-outline-primary" title="Edit">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button *ngIf="collateral.status === 1" (click)="deleteCollateral(collateral.id)" class="action-btn btn btn-sm btn-outline-danger" title="Delete">
                    <i class="bi bi-trash"></i>
                  </button>
                  <button *ngIf="collateral.status !== 1" (click)="restoreCollateral(collateral.id)" class="action-btn btn btn-sm btn-outline-success" title="Restore">
                    <i class="bi bi-arrow-counterclockwise"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <!-- Pagination -->
        <nav *ngIf="paginatedCollaterals.length > 0" class="d-flex justify-content-between align-items-center mt-4">
          <div class="text-muted">
            Showing {{ (currentPage - 1) * itemsPerPage + 1 }} to {{ Math.min(currentPage * itemsPerPage, totalItems) }} of {{ totalItems }} entries
          </div>
          <ul class="pagination mb-0">
            <li class="page-item" [class.disabled]="currentPage === 1">
              <button class="page-link" (click)="goToPage(1)" title="First Page">
                <i class="bi bi-chevron-double-left"></i>
              </button>
            </li>
            <li class="page-item" [class.disabled]="currentPage === 1">
              <button class="page-link" (click)="goToPage(currentPage - 1)" title="Previous Page">
                <i class="bi bi-chevron-left"></i>
              </button>
            </li>
            <li *ngFor="let page of getPageNumbers()" class="page-item" [class.active]="currentPage === page">
              <button class="page-link" (click)="goToPage(page)">{{ page }}</button>
            </li>
            <li class="page-item" [class.disabled]="currentPage === getTotalPages()">
              <button class="page-link" (click)="goToPage(currentPage + 1)" title="Next Page">
                <i class="bi bi-chevron-right"></i>
              </button>
            </li>
            <li class="page-item" [class.disabled]="currentPage === getTotalPages()">
              <button class="page-link" (click)="goToPage(getTotalPages())" title="Last Page">
                <i class="bi bi-chevron-double-right"></i>
              </button>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>